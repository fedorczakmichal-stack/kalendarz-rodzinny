<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organizator Rodzinny</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffeef3 0%, #f0e6ff 50%, #e6f3ff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.08);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #ffd3e1 0%, #e1d8ff 50%, #c8e6ff 100%);
            color: #6b4c93;
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid rgba(255, 255, 255, 0.3);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.5);
            font-weight: 300;
        }

        .month-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .month-selector, .year-selector {
            padding: 10px 15px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.7);
            color: #6b4c93;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .month-selector:focus, .year-selector:focus {
            outline: none;
            border-color: #c8a8d8;
            box-shadow: 0 0 15px rgba(200, 168, 216, 0.3);
        }

        .month-title {
            font-size: 1.4em;
            color: #6b4c93;
            margin: 10px 0;
            font-weight: 400;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f4ff 0%, #fff8fc 100%);
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,244,255,0.9) 100%);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(107, 76, 147, 0.1);
            border: 1px solid rgba(200, 168, 216, 0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
        }

        .stat-number {
            font-size: 2.2em;
            font-weight: 600;
            background: linear-gradient(135deg, #c8a8d8 0%, #a8c8e8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #6b4c93;
            margin-top: 8px;
            font-weight: 500;
        }

        .table-container {
            padding: 25px;
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.5);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(107, 76, 147, 0.1);
            table-layout: fixed;
            min-width: 1100px;
        }

        th {
            background: linear-gradient(135deg, #e1d8ff 0%, #ffd3e1 50%, #c8e6ff 100%);
            color: #6b4c93;
            padding: 18px 8px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
            border-right: 1px solid rgba(255, 255, 255, 0.3);
            vertical-align: middle;
            font-size: 13px;
            line-height: 1.3;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.7);
        }

        /* Konkretne szerokości kolumn */
        th:nth-child(1) { width: 80px; }   /* Data */
        th:nth-child(2) { width: 100px; }  /* Dzień */
        th:nth-child(3) { width: 150px; }  /* Ania Praca */
        th:nth-child(4) { width: 150px; }  /* Ania Inne */
        th:nth-child(5) { width: 150px; }  /* Michał Praca */
        th:nth-child(6) { width: 150px; }  /* Michał Inne */
        th:nth-child(7) { width: 130px; }  /* Niania */
        th:nth-child(8) { width: 130px; }  /* Inne */
        th:nth-child(9) { width: 100px; }  /* Priorytet */

        td {
            padding: 12px 8px;
            text-align: center;
            border-bottom: 1px solid rgba(200, 168, 216, 0.1);
            vertical-align: middle;
            transition: background-color 0.3s ease;
        }

        .date-cell {
            font-weight: 600;
            color: #6b4c93;
        }

        .day-cell {
            font-weight: 500;
            color: #8a6ba0;
        }

        .weekend {
            background: linear-gradient(135deg, #ffeef7 0%, #fff0f8 100%);
            color: #d1477a;
        }

        .weekday {
            background: linear-gradient(135deg, #f8f4ff 0%, #fafbff 100%);
        }

        .input-cell {
            padding: 8px;
        }

        .task-input {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(200, 168, 216, 0.3);
            border-radius: 10px;
            font-size: 13px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            color: #6b4c93;
        }

        .task-input:focus {
            outline: none;
            border-color: #c8a8d8;
            box-shadow: 0 0 15px rgba(200, 168, 216, 0.2);
            background: rgba(255, 255, 255, 1);
        }

        .task-input.filled {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0fff0 100%);
            border-color: #90c695;
            color: #2d5a32;
        }

        .priority-select {
            width: 100%;
            padding: 8px;
            border: 2px solid rgba(200, 168, 216, 0.3);
            border-radius: 8px;
            font-size: 12px;
            background: rgba(255, 255, 255, 0.8);
            color: #6b4c93;
            cursor: pointer;
        }

        .priority-high { 
            background: linear-gradient(135deg, #ffe6ee 0%, #ffebf0 100%);
            border-color: #ff9fb3; 
            color: #cc4465;
        }
        .priority-medium { 
            background: linear-gradient(135deg, #fff3e6 0%, #fff7ed 100%);
            border-color: #ffcc99; 
            color: #cc7722;
        }
        .priority-low { 
            background: linear-gradient(135deg, #e6f3ff 0%, #f0f8ff 100%);
            border-color: #99ccff; 
            color: #2266cc;
        }

        .controls {
            padding: 25px;
            background: linear-gradient(135deg, #f8f4ff 0%, #fff8fc 100%);
            border-top: 1px solid rgba(200, 168, 216, 0.2);
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            font-size: 14px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #e1d8ff 0%, #c8e6ff 100%);
            color: #6b4c93;
        }

        .btn-success {
            background: linear-gradient(135deg, #d4f1d4 0%, #e8f5e8 100%);
            color: #2d5a32;
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffe6ee 0%, #ffebf0 100%);
            color: #cc4465;
        }

        .btn-info {
            background: linear-gradient(135deg, #fff3e6 0%, #fff7ed 100%);
            color: #cc7722;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .summary-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f4ff 0%, #fff8fc 100%);
            border-radius: 15px;
            border: 1px solid rgba(200, 168, 216, 0.2);
        }

        .summary-section h3 {
            color: #6b4c93;
            font-weight: 500;
            margin-bottom: 10px;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .summary-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,244,255,0.9) 100%);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(107, 76, 147, 0.08);
            border: 1px solid rgba(200, 168, 216, 0.2);
        }

        .summary-card h4 {
            color: #6b4c93;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .summary-card p {
            color: #8a6ba0;
            margin: 5px 0;
        }

        .summary-card small {
            color: #a084b8;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(200, 168, 216, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #c8a8d8 0%, #a8c8e8 100%);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .today-highlight {
            background: linear-gradient(135deg, #fff9c4 0%, #ffffcc 100%) !important;
            font-weight: bold;
            animation: pulse 2s infinite;
            box-shadow: 0 0 10px rgba(255, 223, 0, 0.3);
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 10px rgba(255, 223, 0, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 223, 0, 0.5); }
            100% { box-shadow: 0 0 10px rgba(255, 223, 0, 0.3); }
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            th, td {
                padding: 8px 4px;
                font-size: 12px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }

            .month-controls {
                flex-direction: column;
                gap: 10px;
            }
        }

        .nav-button {
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(225,216,255,0.9) 100%);
            border: 2px solid rgba(200, 168, 216, 0.5);
            color: #6b4c93;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-button:hover {
            background: linear-gradient(135deg, #e1d8ff 0%, #ffd3e1 100%);
            transform: translateY(-1px);
        }

        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏠 Organizator Rodzinny</h1>
            
            <div class="month-controls">
                <button class="nav-button" onclick="changeMonth(-1)">← Poprzedni</button>
                
                <select class="month-selector" id="monthSelect" onchange="updateCalendar()">
                    <option value="0">Styczeń</option>
                    <option value="1">Luty</option>
                    <option value="2">Marzec</option>
                    <option value="3">Kwiecień</option>
                    <option value="4">Maj</option>
                    <option value="5">Czerwiec</option>
                    <option value="6">Lipiec</option>
                    <option value="7">Sierpień</option>
                    <option value="8">Wrzesień</option>
                    <option value="9">Październik</option>
                    <option value="10" selected>Listopad</option>
                    <option value="11">Grudzień</option>
                </select>

                <select class="year-selector" id="yearSelect" onchange="updateCalendar()">
                    <option value="2024">2024</option>
                    <option value="2025" selected>2025</option>
                    <option value="2026">2026</option>
                    <option value="2027">2027</option>
                </select>

                <button class="nav-button" onclick="changeMonth(1)">Następny →</button>
            </div>

            <div class="month-title" id="monthTitle">
                Listopad 2025 - Planowanie dla Ani, Michała i niani
            </div>
        </div>

        <div class="stats" id="statsContainer">
            <!-- Statystyki będą generowane dynamicznie -->
        </div>

        <div class="table-container">
            <table id="organizerTable">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Dzień</th>
                        <th>Ania<br/>Praca</th>
                        <th>Ania<br/>Inne</th>
                        <th>Michał<br/>Praca</th>
                        <th>Michał<br/>Inne</th>
                        <th>Niania</th>
                        <th>Inne</th>
                        <th>Priorytet</th>
                    </tr>
                </thead>
                <tbody id="organizerBody">
                    <!-- Wiersze będą generowane dynamicznie -->
                </tbody>
            </table>
        </div>

        <div class="summary-section">
            <h3>📊 Podsumowanie miesięczne</h3>
            <div class="summary-grid" id="summaryGrid">
                <!-- Podsumowania będą generowane dynamicznie -->
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="fillSampleData()">
                📝 Wypełnij przykładowymi danymi
            </button>
            <button class="btn btn-success" onclick="exportToCSV()">
                📥 Eksportuj do CSV
            </button>
            <button class="btn btn-warning" onclick="clearAllData()">
                🗑️ Wyczyść wszystkie dane
            </button>
            <button class="btn btn-info" onclick="autoBalance()">
                ⚖️ Automatyczny podział obowiązków
            </button>
        </div>
    </div>

    <script>
        // Stan organizatora
        let organizerData = {};
        let currentMonth = 10; // listopad (0-based)
        let currentYear = 2025;
        
        // Nazwy miesięcy
        const monthNames = [
            'Styczeń', 'Luty', 'Marzec', 'Kwiecień', 'Maj', 'Czerwiec',
            'Lipiec', 'Sierpień', 'Wrzesień', 'Październik', 'Listopad', 'Grudzień'
        ];

        // Nazwy miesięcy w dopełniaczu dla daty
        const monthNamesGenitive = [
            'stycznia', 'lutego', 'marca', 'kwietnia', 'maja', 'czerwca',
            'lipca', 'sierpnia', 'września', 'października', 'listopada', 'grudnia'
        ];

        // Skróty miesięcy
        const monthAbbr = [
            'sty', 'lut', 'mar', 'kwi', 'maj', 'cze',
            'lip', 'sie', 'wrz', 'paź', 'lis', 'gru'
        ];
        
        // Wygenerowanie dat dla danego miesiąca i roku
        function generateDatesForMonth(month, year) {
            const dates = [];
            const daysOfWeek = ['niedziela', 'poniedziałek', 'wtorek', 'środa', 'czwartek', 'piątek', 'sobota'];
            
            // Sprawdź ile dni ma miesiąc
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month, day);
                const dayName = daysOfWeek[date.getDay()];
                const isWeekend = dayName === 'sobota' || dayName === 'niedziela';
                
                dates.push({
                    day: day,
                    date: `${day} ${monthAbbr[month]}`,
                    dayName: dayName,
                    isWeekend: isWeekend,
                    fullDate: date
                });
            }
            return dates;
        }

        // Sprawdzenie czy dzień to dzisiaj
        function isToday(date) {
            const today = new Date();
            return date.getDate() === today.getDate() && 
                   date.getMonth() === today.getMonth() && 
                   date.getFullYear() === today.getFullYear();
        }

        // Zmiana miesiąca
        function changeMonth(direction) {
            currentMonth += direction;
            
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            } else if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            
            document.getElementById('monthSelect').value = currentMonth;
            document.getElementById('yearSelect').value = currentYear;
            
            updateCalendar();
        }

        // Aktualizacja kalendarza
        function updateCalendar() {
            currentMonth = parseInt(document.getElementById('monthSelect').value);
            currentYear = parseInt(document.getElementById('yearSelect').value);
            
            // Aktualizuj tytuł
            document.getElementById('monthTitle').textContent = 
                `${monthNames[currentMonth]} ${currentYear} - Planowanie dla Ani, Michała i niani`;
            
            // Wygeneruj nową tabelę
            generateTable();
        }

        // Generowanie tabeli
        function generateTable() {
            const dates = generateDatesForMonth(currentMonth, currentYear);
            const tbody = document.getElementById('organizerBody');
            tbody.innerHTML = '';

            dates.forEach((dateInfo, index) => {
                const row = document.createElement('tr');
                const rowClass = dateInfo.isWeekend ? 'weekend' : 'weekday';
                const todayClass = isToday(dateInfo.fullDate) ? 'today-highlight' : '';
                
                const monthKey = `${currentYear}-${currentMonth}`;
                const dayKey = `${monthKey}-${dateInfo.day}`;
                
                row.innerHTML = `
                    <td class="date-cell ${rowClass} ${todayClass}">${dateInfo.date}</td>
                    <td class="day-cell ${rowClass} ${todayClass}">${dateInfo.dayName}</td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="aniaWork" 
                               placeholder="np. 9-17 biuro">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="aniaOther" 
                               placeholder="np. siłownia 18:00">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="michalWork" 
                               placeholder="np. 8-16 zdalnie">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="michalOther" 
                               placeholder="np. spotkanie 19:00">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="niania" 
                               placeholder="np. 10-16">
                    </td>
                    <td class="input-cell">
                        <input type="text" class="task-input" 
                               data-month="${currentMonth}" data-year="${currentYear}"
                               data-day="${dateInfo.day}" data-field="inne" 
                               placeholder="notatki">
                    </td>
                    <td class="input-cell">
                        <select class="priority-select" data-month="${currentMonth}" data-year="${currentYear}" data-day="${dateInfo.day}" data-field="priority">
                            <option value="low">Niski</option>
                            <option value="medium" selected>Średni</option>
                            <option value="high">Wysoki</option>
                        </select>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Przywróć dane dla bieżącego miesiąca
            loadDataForCurrentMonth();
            
            // Dodanie event listenerów
            addEventListeners();
            updateStatistics();
        }

        // Ładowanie danych dla bieżącego miesiąca
        function loadDataForCurrentMonth() {
            const monthKey = `${currentYear}-${currentMonth}`;
            const monthData = organizerData[monthKey];
            
            if (monthData) {
                Object.keys(monthData).forEach(day => {
                    const dayData = monthData[day];
                    Object.keys(dayData).forEach(field => {
                        const input = document.querySelector(`[data-month="${currentMonth}"][data-year="${currentYear}"][data-day="${day}"][data-field="${field}"]`);
                        if (input) {
                            input.value = dayData[field];
                            
                            if (input.classList.contains('task-input') && input.value.trim()) {
                                input.classList.add('filled');
                            }
                            
                            if (input.classList.contains('priority-select')) {
                                input.className = 'priority-select priority-' + input.value;
                            }
                        }
                    });
                });
            }
        }

        // Dodanie event listenerów
        function addEventListeners() {
            document.querySelectorAll('.task-input, .priority-select').forEach(input => {
                input.addEventListener('input', function() {
                    const month = this.dataset.month;
                    const year = this.dataset.year;
                    const day = this.dataset.day;
                    const field = this.dataset.field;
                    
                    const monthKey = `${year}-${month}`;
                    
                    if (!organizerData[monthKey]) {
                        organizerData[monthKey] = {};
                    }
                    
                    if (!organizerData[monthKey][day]) {
                        organizerData[monthKey][day] = {};
                    }
                    
                    organizerData[monthKey][day][field] = this.value;
                    
                    // Aktualizacja stylu inputa
                    if (this.classList.contains('task-input')) {
                        if (this.value.trim()) {
                            this.classList.add('filled');
                        } else {
                            this.classList.remove('filled');
                        }
                    }
                    
                    // Aktualizacja stylu select
                    if (this.classList.contains('priority-select')) {
                        this.className = 'priority-select priority-' + this.value;
                    }
                    
                    updateStatistics();
                });
            });
        }

        // Aktualizacja statystyk
        function updateStatistics() {
            const stats = calculateStatistics();
            displayStatistics(stats);
            displaySummary(stats);
        }

        // Obliczanie statystyk
        function calculateStatistics() {
            const dates = generateDatesForMonth(currentMonth, currentYear);
            let totalDays = dates.length;
            let plannedDays = 0;
            let workDaysAnia = 0;
            let workDaysMichal = 0;
            let naniaDays = 0;
            let highPriorityDays = 0;
            let weekendDays = dates.filter(d => d.isWeekend).length;

            const monthKey = `${currentYear}-${currentMonth}`;
            const monthData = organizerData[monthKey];

            if (monthData) {
                Object.keys(monthData).forEach(day => {
                    const dayData = monthData[day];
                    
                    if (dayData.aniaWork || dayData.aniaOther || dayData.michalWork || 
                        dayData.michalOther || dayData.niania || dayData.inne) {
                        plannedDays++;
                    }
                    
                    if (dayData.aniaWork) {
                        workDaysAnia++;
                    }
                    
                    if (dayData.michalWork) {
                        workDaysMichal++;
                    }
                    
                    if (dayData.niania) {
                        naniaDays++;
                    }
                    
                    if (dayData.priority === 'high') {
                        highPriorityDays++;
                    }
                });
            }

            return {
                totalDays,
                plannedDays,
                workDaysAnia,
                workDaysMichal,
                naniaDays,
                highPriorityDays,
                weekendDays,
                planningProgress: (plannedDays / totalDays * 100).toFixed(1)
            };
        }

        // Wyświetlanie statystyk
        function displayStatistics(stats) {
            const container = document.getElementById('statsContainer');
            container.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${stats.plannedDays}</div>
                    <div class="stat-label">Dni zaplanowane</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${stats.planningProgress}%"></div>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.workDaysAnia}</div>
                    <div class="stat-label">Dni pracy Ani</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.workDaysMichal}</div>
                    <div class="stat-label">Dni pracy Michała</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.naniaDays}</div>
                    <div class="stat-label">Dni z nianią</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${stats.highPriorityDays}</div>
                    <div class="stat-label">Dni priorytetowe</div>
                </div>
            `;
        }

        // Wyświetlanie podsumowania
        function displaySummary(stats) {
            const container = document.getElementById('summaryGrid');
            const workBalance = Math.abs(stats.workDaysAnia - stats.workDaysMichal);
            
            container.innerHTML = `
                <div class="summary-card">
                    <h4>🎯 Postęp planowania</h4>
                    <p><strong>${stats.plannedDays}</strong> z <strong>${stats.totalDays}</strong> dni zaplanowane</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${stats.planningProgress}%"></div>
                    </div>
                    <small>${stats.planningProgress}% ukończone</small>
                </div>
                
                <div class="summary-card">
                    <h4>⚖️ Balans pracy</h4>
                    <p>Ania: <strong>${stats.workDaysAnia}</strong> dni</p>
                    <p>Michał: <strong>${stats.workDaysMichal}</strong> dni</p>
                    <small>${workBalance === 0 ? '✅ Idealny balans!' : `❗ Różnica: ${workBalance} dni`}</small>
                </div>
                
                <div class="summary-card">
                    <h4>👶 Opieka nad dzieckiem</h4>
                    <p>Dni z nianią: <strong>${stats.naniaDays}</strong></p>
                    <p>Weekendy: <strong>${stats.weekendDays}</strong></p>
                    <small>Pokrycie: ${stats.totalDays > stats.weekendDays ? ((stats.naniaDays / (stats.totalDays - stats.weekendDays)) * 100).toFixed(1) : 0}% dni roboczych</small>
                </div>
                
                <div class="summary-card">
                    <h4>📅 Priorytety miesiąca</h4>
                    <p>Dni priorytetowe: <strong>${stats.highPriorityDays}</strong></p>
                    <p>Dni zwykłe: <strong>${stats.plannedDays - stats.highPriorityDays}</strong></p>
                    <small>${stats.highPriorityDays > 0 ? `${((stats.highPriorityDays / stats.plannedDays) * 100).toFixed(1)}% dni to priorytety` : 'Brak dni priorytetowych'}</small>
                </div>
            `;
        }

        // Wypełnienie przykładowymi danymi
        function fillSampleData() {
            const dates = generateDatesForMonth(currentMonth, currentYear);
            const monthKey = `${currentYear}-${currentMonth}`;
            
            if (!organizerData[monthKey]) {
                organizerData[monthKey] = {};
            }
            
            // Dodaj przykładowe dane dla pierwszych kilku dni
            const sampleDays = [1, 3, 5, 7, 10, 15, 20, 25];
            
            sampleDays.forEach((day, index) => {
                if (day <= dates.length) {
                    const isWeekend = dates.find(d => d.day === day)?.isWeekend;
                    
                    if (!organizerData[monthKey][day]) {
                        organizerData[monthKey][day] = {};
                    }
                    
                    if (isWeekend) {
                        organizerData[monthKey][day] = {
                            aniaOther: 'odpoczynek',
                            michalOther: 'odpoczynek',
                            priority: 'low'
                        };
                    } else {
                        organizerData[monthKey][day] = {
                            aniaWork: index % 2 === 0 ? '9-17 biuro' : '9-17 zdalnie',
                            michalWork: index % 2 === 0 ? '8-16 zdalnie' : '8-16 biuro',
                            niania: '10-16',
                            priority: index % 3 === 0 ? 'high' : 'medium'
                        };
                    }
                }
            });

            // Załaduj dane do interfejsu
            loadDataForCurrentMonth();
            updateStatistics();
            alert('✅ Wypełniono organizator przykładowymi danymi!');
        }

        // Automatyczny podział obowiązków
        function autoBalance() {
            const dates = generateDatesForMonth(currentMonth, currentYear);
            const workDays = dates.filter(d => !d.isWeekend);
            const monthKey = `${currentYear}-${currentMonth}`;
            
            if (!organizerData[monthKey]) {
                organizerData[monthKey] = {};
            }
            
            // Wyczyść obecne dane pracy
            workDays.forEach((dateInfo, index) => {
                const day = dateInfo.day;
                if (!organizerData[monthKey][day]) organizerData[monthKey][day] = {};
                
                // Alternuj dni pracy między Anią a Michałem
                if (index % 2 === 0) {
                    organizerData[monthKey][day].aniaWork = '9-17 biuro';
                    organizerData[monthKey][day].michalWork = '8-16 zdalnie';
                } else {
                    organizerData[monthKey][day].aniaWork = '9-17 zdalnie';
                    organizerData[monthKey][day].michalWork = '8-16 biuro';
                }
                
                organizerData[monthKey][day].niania = '10-16';
                organizerData[monthKey][day].priority = 'medium';
            });

            // Załaduj dane do interfejsu
            loadDataForCurrentMonth();
            updateStatistics();
            alert('⚖️ Automatycznie podzielono obowiązki między Anią a Michałem!');
        }

        // Eksport do CSV
        function exportToCSV() {
            const dates = generateDatesForMonth(currentMonth, currentYear);
            const monthKey = `${currentYear}-${currentMonth}`;
            const monthData = organizerData[monthKey] || {};
            
            let csv = 'Data,Dzień,Ania Praca,Ania Inne,Michał Praca,Michał Inne,Niania,Inne,Priorytet\n';
            
            dates.forEach(dateInfo => {
                const day = dateInfo.day;
                const data = monthData[day] || {};
                
                csv += `${dateInfo.date},${dateInfo.dayName},`;
                csv += `"${data.aniaWork || ''}","${data.aniaOther || ''}",`;
                csv += `"${data.michalWork || ''}","${data.michalOther || ''}",`;
                csv += `"${data.niania || ''}","${data.inne || ''}",`;
                csv += `${data.priority || 'medium'}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `organizator_rodzinny_${monthNames[currentMonth].toLowerCase()}_${currentYear}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Wyczyść wszystkie dane
        function clearAllData() {
            if (confirm('❓ Czy na pewno chcesz wyczyścić wszystkie dane dla tego miesiąca?')) {
                const monthKey = `${currentYear}-${currentMonth}`;
                organizerData[monthKey] = {};
                
                document.querySelectorAll('.task-input, .priority-select').forEach(input => {
                    if (input.classList.contains('task-input')) {
                        input.value = '';
                        input.classList.remove('filled');
                    } else if (input.classList.contains('priority-select')) {
                        input.value = 'medium';
                        input.className = 'priority-select priority-medium';
                    }
                });
                
                updateStatistics();
                alert('🗑️ Wszystkie dane zostały wyczyszczone!');
            }
        }

        // Inicjalizacja po załadowaniu strony
        document.addEventListener('DOMContentLoaded', function() {
            generateTable();
        });
    </script>
</body>
</html>
